<%
  # Gitolite Display Access
  gitolite_user                = Setting.plugin_openproject_git_hosting[:gitolite_user]
  ssh_server_domain            = Setting.plugin_openproject_git_hosting[:ssh_server_domain]

  gitolite_global_storage_dir  = Setting.plugin_openproject_git_hosting[:gitolite_global_storage_dir]
  gitolite_redmine_storage_dir = Setting.plugin_openproject_git_hosting[:gitolite_redmine_storage_dir]

  http_server_subdir           = Setting.plugin_openproject_git_hosting[:http_server_subdir]

  http_server_domain           = OpenProject::GitHosting::GitoliteWrapper.http_root_url
  https_server_domain          = OpenProject::GitHosting::GitoliteWrapper.https_root_url

  hierarchical_organisation    = OpenProject::GitHosting::GitoliteWrapper.true?(:hierarchical_organisation)
%>

<div class="git_hosting_access_box">

  <h3><%= l(:label_current_access_patterns) %></h3>

  <span><%= raw l(:display_access_setup1) %></span>
  <br/><br/>
  <span><%= raw l(:display_access_setup2) %></span>
  <br/><br/>
  <span><%= raw l(:display_access_setup3) %></span>

  <p>
    <label><%= l(:label_default_repository) %></label>
    <br/>

    <label><%= l(:label_storage_directory) %> :</label>
    <%= raw "~#{gitolite_user}/#{gitolite_global_storage_dir}#{gitolite_redmine_storage_dir}<em>#{hierarchical_organisation ? 'project1/project2/' : ''}project3.git</em>" %>

    <br/>

    <label><%= l(:label_ssh_access) %> :</label>
    <% gitSHP = ssh_server_domain =~ /:\d+$/ %>
    <%= raw "#{gitSHP ? 'ssh://' : ''}#{gitolite_user}@#{ssh_server_domain}#{gitSHP ? '/' : ':'}#{gitolite_redmine_storage_dir}<em>#{hierarchical_organisation ? 'project1/project2/' : ''}project3.git</em>" %>

    <br/>

    <label><%= l(:label_http_access) %> :</label>
    <%= raw "http://<em>redmine-user</em>@#{http_server_domain}/#{http_server_subdir}<em>#{hierarchical_organisation ? 'project1/project2/' : ''}project3.git</em>" %>

    <br/>

    <label><%= l(:label_https_access) %> :</label>
    <%= raw "https://<em>redmine-user</em>@#{https_server_domain}/#{http_server_subdir}<em>#{hierarchical_organisation ? 'project1/project2/' : ''}project3.git</em>" %>
  </p>

  <p>
    <label><%= l(:label_example_repository) %></label>
    <br/>

    <label><%= l(:label_storage_directory) %> :</label>
    <%= raw "~#{gitolite_user}/#{gitolite_global_storage_dir}#{gitolite_redmine_storage_dir}<em>#{hierarchical_organisation ? 'project1/project2/project3/' : ''}example.git</em>" %>

    <br/>

    <label><%= l(:label_ssh_access) %> :</label>
    <% gitSHP = ssh_server_domain =~ /:\d+$/ %>
    <%= raw "#{gitSHP ? 'ssh://' : ''}#{gitolite_user}@#{ssh_server_domain}#{gitSHP ? '/' : ':'}#{gitolite_redmine_storage_dir}<em>#{hierarchical_organisation ? 'project1/project2/project3/' : ''}example.git</em>" %>

    <br/>

    <label><%= l(:label_http_access) %> :</label>
    <%= raw "http://<em>redmine-user</em>@#{http_server_domain}/#{http_server_subdir}<em>#{hierarchical_organisation ? 'project1/project2/project3/' : ''}example.git</em>" %>

    <br/>

    <label><%= l(:label_https_access) %> :</label>
    <%= raw "https://<em>redmine-user</em>@#{https_server_domain}/#{http_server_subdir}<em>#{hierarchical_organisation ? 'project1/project2/project3/' : ''}example.git</em>" %>

    <br/>
    <br/>

    <label><%= l(:label_etcetera) %>...</label>
  </p>

  <%= raw l(:display_access_emphasis) %>
  <%= raw hierarchical_organisation ? l(:display_access_hierarchical) : l(:display_access_flat) %>

</div>
